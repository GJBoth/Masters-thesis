<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta http-equiv="Content-Style-Type" content="text/css" />
        <meta name="generator" content="pandoc" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
                        <title>01_title_page</title>
        <style type="text/css">code{white-space: pre;}</style>
                                            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
                            <style>
            body {
                font-family: Georgia;
                max-width: 800px;
                margin: 0 auto;
                line-height: 30px;
                font-size: 18px;
                padding-left: 350px;
                padding-right: 50px;
                color: #111;
            }
            
            h1, h2, h3, h4, h5, h6 {
                font-family: Arial;
            }
            
            h1 {
                padding-top: 200px;
                line-height: 50px;
            }
            h2 {
                padding-top: 30px;
            }
            h3 {
                padding-top: 20px;
            }
            h4 {
                padding-top: 10px;
            }
            p {
                text-align: justify;
            }
            p a {
                word-wrap: break-word;
                white-space: pre;
            }
            code {
                word-wrap: break-word;
            }
            blockquote {
                border-left: 3px solid #eee;
                margin-left: 20px;
                padding-left: 20px;
            }
            
            ::selection {
                background-color: #E4E4E4;
            }
            
            table {
                width: 100%;
            }
            table caption {
                font-weight: bold;
            }
            table tr {
                padding: 0;
                margin: 0;
                background-color: #f0f0f0;
            }
            table tr.even {
                background-color: #fafafa;
            }
            table td {
                margin: 0;
                padding: 3px 5px;
            }
            
            p span.added {
                color: green;
                background-color: #FFF3C5;
            }
            p span.removed {
                color: red;
                background-color: #FFF3C5;
            }
            
            #title-page {
                padding: 80px 0;
            }
            
            #TOC {
                position: fixed;
                left: 0;
                top: 0;
                overflow-y: scroll;
                height: 100%;
                background: #fafafa;
                max-width: 300px;
                font-family: Arial;
                font-size: 15px;
                line-height: 30px;
            }
            ::-webkit-scrollbar {
                width: 8px;
            }
            ::-webkit-scrollbar-track {
                background-color: #ECECEC;
            }
            ::-webkit-scrollbar-thumb {
                background-color: #B0B0B0;
                border-radius: 8px;
            }
            #TOC > ul {
                padding-right: 10px;
            }
            #TOC ul {
                list-style: none;
                padding-left: 20px;
            }
            #TOC ul li a {
                text-decoration: none;
                color: #364149;
                text-overflow: ellipsis;
                display: block;
                white-space: nowrap;
                overflow: hidden;
            }
            #TOC ul li a:hover {
                color: #008cff;
            }
            
            .figure {
                text-align: center;
            }
            .figure p {
                text-align: center;
                font-style: italic;
            }
            .figure img {
                  width: 100%;
            }
            </style>
                <script src="js/jquery.js"></script>
        <script src="js/diff.js"></script>
        <script src="js/main.js"></script>
    </head>
    <body>
                <!--
                -->
        <div id="title-page">
            <h1>This is the title of the thesis</h1>
            <h2>Firstname Surname</h2>
        </div>
                    <div id="TOC">
                <ul>
                <li><a href="#abstract">Abstract</a></li>
                <li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a><ul>
                <li><a href="#quantitative-work-on-the-golgi-so-far"><span class="toc-section-number">1.1</span> Quantitative work on the Golgi so far</a></li>
                <li><a href="#rush-system"><span class="toc-section-number">1.2</span> RUSH system</a><ul>
                <li><a href="#man-ii"><span class="toc-section-number">1.2.1</span> Man II</a></li>
                </ul></li>
                </ul></li>
                <li><a href="#introduction-1"><span class="toc-section-number">2</span> Introduction</a></li>
                <li><a href="#data-processing-pipeline"><span class="toc-section-number">3</span> Data processing pipeline</a><ul>
                <li><a href="#step-1-segmentation"><span class="toc-section-number">3.1</span> Step 1: Segmentation</a><ul>
                <li><a href="#voronoi-diagram"><span class="toc-section-number">3.1.1</span> Voronoi diagram</a></li>
                <li><a href="#intensity"><span class="toc-section-number">3.1.2</span> Intensity</a></li>
                </ul></li>
                <li><a href="#step-2---denoising"><span class="toc-section-number">3.2</span> Step 2 - Denoising</a><ul>
                <li><a href="#wavelet-filter">Wavelet filter</a></li>
                <li><a href="#proper-orthogonal-decomposition">Proper orthogonal decomposition</a></li>
                <li><a href="#wavinpod">WavinPOD</a></li>
                </ul></li>
                <li><a href="#step-3---derivatives"><span class="toc-section-number">3.3</span> Step 3 - Derivatives</a></li>
                <li><a href="#step-4---fitting"><span class="toc-section-number">3.4</span> Step 4 - Fitting</a></li>
                </ul></li>
                <li><a href="#results-data-analysis"><span class="toc-section-number">4</span> Results data analysis</a><ul>
                <li><a href="#analysis-of-time-derivatives"><span class="toc-section-number">4.1</span> Analysis of time derivatives</a></li>
                <li><a href="#analysis-of-fit"><span class="toc-section-number">4.2</span> Analysis of fit</a><ul>
                <li><a href="#diffusion"><span class="toc-section-number">4.2.1</span> Diffusion</a></li>
                <li><a href="#advection"><span class="toc-section-number">4.2.2</span> Advection</a></li>
                </ul></li>
                </ul></li>
                <li><a href="#physics-informed-neural-networks"><span class="toc-section-number">5</span> Physics Informed Neural Networks</a><ul>
                <li><a href="#neural-networks"><span class="toc-section-number">5.1</span> Neural Networks</a><ul>
                <li><a href="#the-basis-the-neuron"><span class="toc-section-number">5.1.1</span> The basis: the neuron</a></li>
                <li><a href="#network"><span class="toc-section-number">5.1.2</span> Network</a></li>
                <li><a href="#training"><span class="toc-section-number">5.1.3</span> Training</a></li>
                </ul></li>
                <li><a href="#physics-informed-neural-networks-1"><span class="toc-section-number">5.2</span> Physics Informed Neural Networks</a><ul>
                <li><a href="#the-concept"><span class="toc-section-number">5.2.1</span> The concept</a></li>
                <li><a href="#pinns-in-practice"><span class="toc-section-number">5.2.2</span> PINNs in practice</a></li>
                </ul></li>
                <li><a href="#conclusion"><span class="toc-section-number">5.3</span> Conclusion</a><ul>
                <li><a href="#weak-points-and-how-to-improve"><span class="toc-section-number">5.3.1</span> Weak points and how to improve</a></li>
                </ul></li>
                </ul></li>
                <li><a href="#conclusion-1"><span class="toc-section-number">6</span> Conclusion</a></li>
                <li><a href="#appendix-1-some-extra-stuff">Appendix 1: Some extra stuff</a></li>
                <li><a href="#references"><span class="toc-section-number">7</span> References</a></li>
                </ul>
            </div>
                                <!-- 
This is the Latex-heavy title page. 
People outside UCL may want to remove the header logo 
and add the centred logo
-->

<h1 id="abstract" class="unnumbered">Abstract</h1>
<!-- This is the abstract -->
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam et turpis gravida, lacinia ante sit amet, sollicitudin erat. Aliquam efficitur vehicula leo sed condimentum. Phasellus lobortis eros vitae rutrum egestas. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Donec at urna imperdiet, vulputate orci eu, sollicitudin leo. Donec nec dui sagittis, malesuada erat eget, vulputate tellus. Nam ullamcorper efficitur iaculis. Mauris eu vehicula nibh. In lectus turpis, tempor at felis a, egestas fermentum massa.</p>




<h1 id="introduction"><span class="header-section-number">1</span> Introduction</h1>
<h2 id="quantitative-work-on-the-golgi-so-far"><span class="header-section-number">1.1</span> Quantitative work on the Golgi so far</h2>
<h2 id="rush-system"><span class="header-section-number">1.2</span> RUSH system</h2>
<figure>
<img src="source/figures/png/D.png" alt="text" /><figcaption>text</figcaption>
</figure>
<h3 id="man-ii"><span class="header-section-number">1.2.1</span> Man II</h3>
<h1 id="introduction-1"><span class="header-section-number">2</span> Introduction</h1>
<h1 id="data-processing-pipeline"><span class="header-section-number">3</span> Data processing pipeline</h1>
<p>In this chapter I present the work done on processing the rush movies. Several preprocssing steps hav been undertaken to improve the quality of the fit, and we present all here. Roughly, we can divide the process in four steps:</p>
<ol type="1">
<li>Segmentation and creation of masks</li>
<li>Denoising of movies</li>
<li>Calculation of spatial and temporal derivatives</li>
<li>The actual fitting</li>
</ol>
<p>Below we describe each step separately.</p>
<h2 id="step-1-segmentation"><span class="header-section-number">3.1</span> Step 1: Segmentation</h2>
<p>The images obtained from the rush experiments often contain multiple cells. Furthermore, we can also segment the image into roughly three different types: 1) the background, where nothing of interest happens. No cells are present here, 2) the cytoplasm, which is the area where we want to fit our model and 3) the Golgi itself, where we do not necessarily want to fit. Unfortunately, no bright field images were available, making segmentation significantly harder, as no clear cell boundary can be observed. Further complicating the story is the large dynamic range of the movies due to the fluorescence concentrating in the Golgi. The following procedures we present have been developed to deal with these problems. Note that they are empirical methods, i.e. there’s no theoretical background as to why they <em>should</em> work. However, in practice they do and I haven’t found any other method which was able to.</p>
<h3 id="voronoi-diagram"><span class="header-section-number">3.1.1</span> Voronoi diagram</h3>
<p>This method is based on a technique called Voronoi tesselation and doesn’t depend on ny measure of the intensity. It was developed after noting that since the cargo is spread throughout the ER in the first few frames and as the ER is roughly circumnuclear, we can use this to determine the centre of the cell (roughly). Voronoi tesselation then allows us to divide the frame into areas with just one point per area, i.e. one cell per area (theoretically). More precise, given <span class="math inline">\(n\)</span> coordinates, voronoi tesselation divides the given area into <span class="math inline">\(n\)</span> pieces, where every point in a piece is closest to one coordinate. In practice this means for us that each point in a cell area is closest to its the given cell centre. Figure <strong>ref</strong> shows this. Each calculated cell centre is a red point and the lines depict the borders between each voronoi cell. Assuming the cells don’t move too much, they don’t cross the cells and thus we apply the voronoi diagram calculated in the first few frames to the entire movie.</p>
<h3 id="intensity"><span class="header-section-number">3.1.2</span> Intensity</h3>
<p>For the fitting however we wish to make a slightly better approach than a voronoi diagram. As stated, we can’t find the exact delineation of the cell, but looking at the intensity, we can see an ‘area’ of interest, separating background from the cell. Since the Golgi is quite bright in het last 200 or so frames, we consider only the intensity for the Golgi, while for the cytoplasm we consider both the intensity and its time derivative. Thus we have two analog but different processes. For the Golgi we do the following:</p>
<ol type="1">
<li>Renormalize the concentration <span class="math inline">\(C\)</span> between 0 and 1.</li>
<li>Sum all frames. One then obtains an image such as figure <strong>ref</strong> <span class="math display">\[x
\sum_{frames}C(x,y,t)
\]</span></li>
<li>This image is thresholded, either through an otsu threshold or a manual one, until the mask roughly matches what we want. Note that extreme precision isn’t required, since we just want the rough area. THis results in figure <strong>ref</strong></li>
</ol>
<p>For the cytoplasm we follow the same procedure only now we take the log of sum of the product of the intensity and its time derivative:</p>
<p><span class="math display">\[
\log\left(\sum_{frames}C(x,y,t)\cdot\partial_tC(x,y,t)\right)
\]</span> We thus obtain a complete mask for the movie as shown in figure <strong>ref</strong></p>
<h2 id="step-2---denoising"><span class="header-section-number">3.2</span> Step 2 - Denoising</h2>
<p>In order to accurately calculate the derivatives and generally improve the quality of fitting, we wish to denoise and smooth the obtained movies. Denoising and smoothing is a subject about which many books have been written and there are hundreds of approaches. One oft-used technique is to Fourier transform the signal, cutoff all coefficients above a cutoff frequency and retransform back into the real domain. Next, a Savitzky-Golay filter can be used to finally smooth the result. However, a big issue with all these methods is their non locality. Since our movies have different scales, this is a big problem. Furthermore, they often smooth out sharp peaks. After evaluating several methods, I have settled on a relatively new method presented in <strong>ref</strong>.</p>
<p>The so-called WavinPOD method combines two well-known filtering techniques, known as wavelet filtering and Proper Orthogonal Decomposition. Below we explain each separately. Our explanation is adapted from <strong>ref</strong> and <strong>ref</strong>.</p>
<h3 id="wavelet-filter" class="unnumbered">Wavelet filter</h3>
<p>A wavelet filter is not really the appropriate name, as its more of a transform.</p>
<h3 id="proper-orthogonal-decomposition" class="unnumbered">Proper orthogonal decomposition</h3>
<p>Proper orthogonal decomposition is a technique similar to what is known as Principal component Analysis in statistics and falls into the general category of model reduction techniques. It’s often used in flow problems to extract coherent structures from turbulent flows. Simply put, in POD we wish to express a function as</p>
<h3 id="wavinpod" class="unnumbered">WavinPOD</h3>
<p>WavinPOD combines these two techniques in the following way. First, we decompose our problem with a POD transformation. This yields a set of temporal and spatial modes. We select the most energetic modes and wavelet filter these, before transforming them back to the real domain. As shown in <strong>ref</strong>, combining these techniques has an advantage over others.</p>
<p>In our case, we select the number of modes to be used by hand (30 in the case of MANII) and apply a 3-level db4 wavelet. We use a slightly higher than necessary level to increase smoothness. In the figure below we show the result for both a pixel in time and one time snapshot. Note that the result is significantly smoother, but that smaller details have been preserved.</p>
<h2 id="step-3---derivatives"><span class="header-section-number">3.3</span> Step 3 - Derivatives</h2>
<p>Taking spatial and temporal derivatives of these images is not an entirely trivial operation due to the discreteness of the system. More specifically, taking numerical derivatives of data is extremely hard to do properly and becomes even harder in the presence of noise. Next to basic finite difference methods, one can for example use a linear-least-squares fitted polynomial, smoothing spline or a so-called tikhonov-regularizer <strong>ref needed</strong>. Each method comes with its strengths and weaknesses, but one particularly nasty thing for our context is that they don’t scale well to higher dimensions and quickly become computationally expensive.</p>
<p>Another issue related to discretization is the size of the grid w.r.t. the size of the features. To see this, we plot a 2D-gaussian with <span class="math inline">\(\sigma=1\)</span> in figure <strong>ref</strong>.</p>
<p>As expected, the derivative is normal to the isolines of the object. Now consider the discretized version of the object. Taking the naive spatial derivate w.r.t. to each direction means only considering a single row or column of and taking the derivative in that direction. Figure <strong>ref</strong> shows the result of this operation. An artifact is clearly visible: instead of a nice uniform derivative, we see a ‘cross’. This effect is a cause of the discretization grid being too large for some smaller, often bright, objects.</p>
<p>To remedy this, one can for example artificially upscale the grid, interpolate the values inbetween, and take the derivates from this grid. This is not ideal however, since the upscaling requires a large amount of memory and is computationally expensive. Another solution which is common in image processing is applying a <em>kernel operator</em>. The advantage of a kernel operator is that it is extremely computationally cheap, as it involves convolving the original picture with a differentiation kernel. The differentiation kernel is an approximate version of a finite difference scheme. We use and show here the Sobel filter, which is the most commonly used one.</p>
<p>In a simple finite central difference scheme, we set</p>
<p><span class="math display">\[
\frac{dx}{dt}\approx\frac{x_{i+1}-x_{i-1}}{2h}
\]</span></p>
<p>where <span class="math inline">\(h\)</span> is the distance between two points. In terms of a kernel operator, this would look like (the <span class="math inline">\(h\)</span> drops out as the distance in terms of pixels is 1):</p>
<p><span class="math display">\[\frac{1}{2}\cdot
\begin{bmatrix}
1 &amp; 0 &amp; -1
\end{bmatrix}
\]</span></p>
<p>And applying it by convoluting it to a matrix gives the x-derivative:</p>
<p><span class="math display">\[
\partial_xA\approx A*\begin{bmatrix}
1 &amp; 0 &amp; -1
\end{bmatrix}
\]</span></p>
<p>and analogous for the y-direction. However, as we’ve seen, looking at just a single row introduces cross-like artifacts. To remedy this, we wish to include diagonal pixels as well. However, the distance between the diagonal pixels and the center pixel is not 1 but <span class="math inline">\(\sqrt{2}\)</span> and furthermore we need to decompose is it into <span class="math inline">\(\hat{x}\)</span> and <span class="math inline">\(\hat{y}\)</span>, introducing another factor <span class="math inline">\(\sqrt{2}\)</span>. Thus, one obtains the classis <span class="math inline">\(3\times3\)</span> Sobel filter <strong>ref</strong>:</p>
<p><span class="math display">\[
\mathbf G_x=\frac{1}{8}\cdot
\begin{bmatrix}
1 &amp; 0 &amp; -1\\
2 &amp; 0 &amp; -2\\
1 &amp; 0 &amp; -1
\end{bmatrix}
\mathbf G_y=\frac{1}{8}\cdot
\begin{bmatrix}
1 &amp; 2 &amp; 1 \\
0 &amp; 0 &amp; 0 \\
-1 &amp; -2 &amp; -1
\end{bmatrix}
\]</span></p>
<p>Although not extremely accurate, the Sobel filter seems to do the tricks for us. Several other versions such as Scharr or Prewitt exist, offering several benefits such as rotational symmetry, but we have not pursued these. They just change the coefficients. Although we have shown a <span class="math inline">\(3\times3\)</span> filter here, the filter can take into account higher order schemes such as a <span class="math inline">\(5\times5\)</span> or <span class="math inline">\(7\times7\)</span>. The major benefit of the spatial derivatives as a convolution operator is its computational efficiency: convolutional operations are performed parallel and are extremely fast.</p>
<p>For the time derivative, we apply a second order accurate central derivative scheme, while for the spatial derivatives (both first and second order) we apply the <span class="math inline">\(5\times5\)</span> Sobel filter. We analyze these in the next chapter</p>
<h2 id="step-4---fitting"><span class="header-section-number">3.4</span> Step 4 - Fitting</h2>
<p>Now that we have gathered all our data we can use it to fit. We use a simple least squares method.</p>
<h1 id="results-data-analysis"><span class="header-section-number">4</span> Results data analysis</h1>
<p>Here we present the results from our analysis on the RUSH experiments. We only show the results of MANII because this is the only thing we studied.</p>
<p>textwidth: </p>
<p>linewidth: </p>
<h2 id="analysis-of-time-derivatives"><span class="header-section-number">4.1</span> Analysis of time derivatives</h2>
<p>Ziet er goed uit chefke.</p>
<figure>
<img src="/Users/gert-janboth/PycharmProjects/Plots_report/Plots/time_derivative.png" alt="Wolla zieke subscript." /><figcaption>Wolla zieke subscript.</figcaption>
</figure>
<h2 id="analysis-of-fit"><span class="header-section-number">4.2</span> Analysis of fit</h2>
<h3 id="diffusion"><span class="header-section-number">4.2.1</span> Diffusion</h3>
<h3 id="advection"><span class="header-section-number">4.2.2</span> Advection</h3>
<h1 id="physics-informed-neural-networks"><span class="header-section-number">5</span> Physics Informed Neural Networks</h1>
<p>In previous chapters we showed the difficulty in finding a general fit for a model to spatiotemporal data. Very recently, a set of papers introduced a new technique called Physics Informed neural networks. The set of papers show very powerful and promising results. I’ve evaluated this technique for use in fitting our model to the RUSH data. Since for many Neural networks are a new technique, this chapter is also a gentle introduction into Neural networks themself. We have three parts:</p>
<ul>
<li>Neural Networks</li>
<li>Physics Informed Neural networks</li>
<li>Conclusion</li>
</ul>
<p>In neural networks we introduce the ideas and some mathematics behind neural networks in Physics informed neural networks we showcase the concept using a simple toy model and in conclusion we present the evaluation of the technique.</p>
<h2 id="neural-networks"><span class="header-section-number">5.1</span> Neural Networks</h2>
<h3 id="the-basis-the-neuron"><span class="header-section-number">5.1.1</span> The basis: the neuron</h3>
<p>The basic of each type of neural network is the same: the neuron. Inspired, but not the same as a biological neural network, the neuron has an input <span class="math inline">\(x\)</span> and transforms it to an output <span class="math inline">\(y\)</span>: <span class="math inline">\(x\to y\)</span>. This is a three step process. The input <span class="math inline">\(x\)</span> is multiplied by a factor <span class="math inline">\(a\)</span> known as a weight and adds a constant known as the bias <span class="math inline">\(b\)</span>. This serves as an input to the <em>activation function</em> <span class="math inline">\(g\)</span> of the neuron, so that <span class="math display">\[
y = g(ax+b)
\]</span> the role of the activation function is to introduce non-linearity into the system. Many research is ongoing into different activation, but one of the most used is the <span class="math inline">\(tanh(x)\)</span> function, due to its biological relevance and bounded in and outputs. Several other functions with more fsvourable properties such as lower computtational cost are available as well.</p>
<p>A neuron always has one output, but can have multiple inputs, for example in the case of multitple neurons feeding into another one. One can also have multiple neurons in a single layer. A natural generalization is that <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> become matrices and <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> vectors: <span class="math display">\[
\vec{y} = g(A\vec{x}+B)
\]</span> where <span class="math inline">\(g\)</span> is applied element wise. The goal of training a neural network is to find the matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> which make sure that <span class="math inline">\(y\)</span> is closest to the desired outcome.</p>
<h3 id="network"><span class="header-section-number">5.1.2</span> Network</h3>
<h3 id="training"><span class="header-section-number">5.1.3</span> Training</h3>
<h2 id="physics-informed-neural-networks-1"><span class="header-section-number">5.2</span> Physics Informed Neural Networks</h2>
<h3 id="the-concept"><span class="header-section-number">5.2.1</span> The concept</h3>
<p>In my point of view, the power of physics informed neural networks comes from two core concepts: the physics regularization and automatic differentiation.</p>
<p>####*</p>
<h3 id="pinns-in-practice"><span class="header-section-number">5.2.2</span> PINNs in practice</h3>
<h4 id="constant-d"><span class="header-section-number">5.2.2.1</span> Constant D</h4>
<h4 id="varying-d"><span class="header-section-number">5.2.2.2</span> Varying D</h4>
<h2 id="conclusion"><span class="header-section-number">5.3</span> Conclusion</h2>
<h3 id="weak-points-and-how-to-improve"><span class="header-section-number">5.3.1</span> Weak points and how to improve</h3>
<h1 id="conclusion-1"><span class="header-section-number">6</span> Conclusion</h1>
<h1 id="appendix-1-some-extra-stuff" class="unnumbered">Appendix 1: Some extra stuff</h1>
<!-- 
This could be a list of papers by the author for example 
-->
<p>Add appendix 1 here. Vivamus hendrerit rhoncus interdum. Sed ullamcorper et augue at porta. Suspendisse facilisis imperdiet urna, eu pellentesque purus suscipit in. Integer dignissim mattis ex aliquam blandit. Curabitur lobortis quam varius turpis ultrices egestas.</p>

<!-- 
Do not edit this page.

References are automatically generated from the BibTex file (References.bib)

...which you should create using your reference manager.
-->
<h1 id="references"><span class="header-section-number">7</span> References</h1>
            </body>
</html>

